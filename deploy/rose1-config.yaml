# mikrotik-kube configuration for rose1.gw.lo (ROSE Data Server)
# This file is mounted at /etc/mikrotik-kube/config.yaml inside the container.
#
# The container runs ON the router at 192.168.200.2 and accesses the
# RouterOS REST API at 192.168.200.1 (the bridge gateway).

nodeName: rose1
standalone: true

routeros:
  address: "192.168.200.1:8728"
  restUrl: "https://192.168.200.1/rest"
  user: admin
  password: ""  # Set via MIKROTIK_KUBE_PASSWORD env var
  useTLS: false
  insecureVerify: true  # RouterOS self-signed cert

networks:
  - name: containers
    bridge: containers
    cidr: "192.168.200.0/24"
    gateway: "192.168.200.1"
    dns:
      endpoint: "http://192.168.200.199:8080"
      zone: "gt.lo"
      server: "192.168.200.199"
  - name: g10
    bridge: bridge
    cidr: "192.168.10.0/24"
    gateway: "192.168.10.1"
    dns:
      endpoint: "http://192.168.10.199:8080"
      zone: "g10.lo"
      server: "192.168.10.199"
  - name: gw
    bridge: bridge-lan
    cidr: "192.168.1.0/24"
    gateway: "192.168.1.1"
    dns:
      endpoint: "http://192.168.1.199:8080"
      zone: "gw.lo"
      server: "192.168.1.199"

storage:
  basePath: /raid1/images
  tarballCache: /raid1/cache
  gcIntervalMinutes: 60
  gcKeepLastN: 10
  gcDryRun: false

systemd:
  bootManifestPath: /etc/mikrotik-kube/boot-order.yaml
  watchdogIntervalSeconds: 15
  maxRestarts: 5
  restartCooldown: 10

registry:
  enabled: true
  listenAddr: ":5000"
  storePath: /raid1/registry
  pullThrough: true
  upstreamRegistries:
    - "docker.io"
    - "ghcr.io"
